
@{
    ViewBag.Title = "Test";
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
</head>
<body>
    <table class="table table-hover" id="pageShow">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>password</th>
        </tr>
    </table>
    <nav aria-label="Page navigation">
        <ul class="pagination" id="page">
            <li class="prePage">
                <a href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</body>
</html>
<script>
    function getdata() {
        $.ajax({
            type: "post",
            dataType: "json",
            url: "/Email/GetResult",
            success: function (res) {
                console.log(res);
                $(function () {
                    var data = res;
                    var pageSize = 5;//每页的条数
                    var totalPage = Math.ceil(data.length / pageSize);//总页数
                    var currentPage;//当前页数
                    var startData;//开始的数据
                    var endData;//结尾的数
                    for (let i = 1; i <= totalPage; i++) {
                        $('#page').append('<li class="page-item"><a href="#">' + i + '</a></li>');
                    }
                    $('#page').append(
                        `<li class="nextPage">
              <a href="#" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
              </a>
           </li>`);
                    function pageination(i) {
                        currentPage = i;
                        console.log('第' + currentPage + '页...');
                        startData = (currentPage - 1) * pageSize;
                        endData = currentPage * pageSize;
                        if (endData > data.length) {
                            endData = data.length;
                        }
                        $('.tr-item').remove();//移除列表显示的数据
                        for (let i = startData; i < endData; i++) {//添加列表显示的数据
                            $('#pageShow').append('<tr class="tr-item">' +
                                '<td>' + data[i].Id + '</td>' +
                                '<td>' + data[i].Name + '</td>' +
                                '<td>' + data[i].password + '</td>' +
                                '</tr>')
                        }
                    }
                    //初始化
                    $('.page-item').eq(0).addClass('active');
                    pageination(1);
                    //对每个页数的点击事件的绑定
                    $('.page-item').on('click', function () {
                        let index = $(this).index();//获取点击的页数
                        $(this).addClass('active').siblings().removeClass('active');
                        pageination(index);
                    })
                    //向前按钮事件绑定
                    $('.prePage').click(function () {
                        $('.page-item').find(function () {
                            let index = $('.active').index() - 1;
                            if (index < 1) {
                                index = 1;
                            }
                            $('.page-item').eq(index - 1).addClass('active').siblings().removeClass('active');
                            pageination(index);
                        })
                    })
                    //向后按钮事件绑定
                    $('.nextPage').click(function () {
                        $('.page-item').find(function () {
                            let index = $('.active').index() + 1;
                            console.log(index);
                            if (index > totalPage) {
                                index = totalPage;
                                console.log(index);
                            }
                            console.log(index);
                            $('.page-item').eq(index - 1).addClass('active').siblings().removeClass('active');
                            pageination(index);
                        })
                    })
                })
            }
        });
    }

    window.onload = getdata();

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
